<div class="hero">
  <h1>Discover & Join Amazing Events</h1>
  <p>Find, create, and manage community events with ease.</p>
  <div style="margin-top:1rem;">
    <a href="/events/new" class="btn btn-accent">+ Create New Event</a>
    <a href="/dashboard" class="btn" style="margin-left:0.5rem;">Dashboard</a>
    <% if (user && user.role === 'admin') { %>
      <a href="/events/admin/pending" class="btn" style="margin-left:0.5rem;background:var(--accent);">Review Pending Events</a>
    <% } %>
  </div>
</div>

<form method="GET" action="/events" class="card" style="margin-bottom:2rem;">
  <div style="display:flex;gap:1rem;flex-wrap:wrap;align-items:center;">
    <input type="text" name="q" placeholder="Search events..." style="flex:2;">
    <select name="category" style="flex:1;">
      <option value="">All Categories</option>
      <option value="Technology">Technology</option>
      <option value="Business">Business</option>
      <option value="Education">Education</option>
      <option value="Entertainment">Entertainment</option>
      <option value="Sports">Sports</option>
      <option value="Other">Other</option>
    </select>
    <input type="date" name="date" style="flex:1;">
    <button class="btn" type="submit">Filter</button>
  </div>
</form>

<div class="container">
  <% if (events && events.length) { %>
    <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(320px,1fr));gap:2rem;">
      <% events.forEach(event => { %>
        <div class="card">
          <img src="<%= event.bannerUrl || '/images/default-event.jpg' %>" alt="Event Banner" style="width:100%;border-radius:var(--radius);margin-bottom:1rem;max-height:180px;object-fit:cover;">
          <div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:0.5rem;">
            <h2 style="margin:0;"><%= event.title %></h2>
            <% if (user && user.role === 'admin') { %>
              <span style="background:var(--primary);color:white;padding:0.25rem 0.5rem;border-radius:var(--radius);font-size:0.75rem;"><%= event.status %></span>
            <% } %>
          </div>
          <p style="color:var(--muted);margin:0 0 1rem 0;"><%= event.location %> &middot; <%= event.date %></p>
          <p><%= event.description ? event.description.substring(0, 100) : '' %>...</p>
          <div style="display:flex;gap:0.5rem;margin-top:1rem;">
            <a href="/events/<%= event._id %>" class="btn btn-accent">View Details</a>
            <% if (user && (String(event.createdBy) === user._id || user.role === 'admin')) { %>
              <a href="/events/<%= event._id %>/edit" class="btn" style="background:var(--accent);">Edit</a>
            <% } %>
          </div>
        </div>
      <% }) %>
    </div>
  <% } else { %>
    <div class="card" style="text-align:center;">
      <h3>No events found</h3>
      <p style="color:var(--muted);margin-bottom:1rem;">Be the first to create an amazing event!</p>
      <a href="/events/new" class="btn btn-accent">Create Your First Event</a>
    </div>
  <% } %>
</div>
